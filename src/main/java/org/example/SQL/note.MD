 SQL
 ### Основа SQL - 
это язык структурированных запросов у которого сформирован стандарт взаимодействия с РСБД.

**Таблица** - один из самых простых инструментов, используемых для записи и визуализации данных. Это двухмерная сетка, состоящая из строк и столбцов.
Таблица может содержать различные типы данных (числовые, символьные, текстовые, дата и время, логические значения).

**База данных** - совокупность данных, упорядоченных для упрощения и скорости поиска и извлечения. Как правило, информация внутри базы данных хранится в виде набора таблиц, которые могут быть взаимосвязаны между собой.

**Основная терминология** - таблица, поле(столбец), запись(строка).

**Реляционная база данных** - связь между данными в базе данных, например связь между таблицами с помощью ключевых полей.

**Первичный ключ** - это уникальный идентификатор записи в таблице, в каждой записи должен быть уникальным и не должен быть пустым.
Хотя первичный ключ должен быть уникальным но другие поля могут содержать данные повторяющееся более чем в одной записи.

**Внешний ключ** -это поле в таблице, значение которого соответствует первичному ключу в другой таблице(внешний ключ в таблице может повторяться, но в таблице для которой он является первичным ключом он должен быть уникальным в ней)

**Составной ключ** - то есть для определения первичного ключа используется два и более поля. Данные первого поля и второго могут повторяться по отдельностью внутри одной таблицы, но только одна запись может иметь одинаковые значения этих полей.

**РСУБД - реляционные системы управления базами данных(MySQL,SQL Server и др.)

**Запрос** - это набор команд, которые возвращает информацию из базы данных в виде записей. Запрос может состоять из нескольких операторов SQL .
Оператор SQL - это выполняемый РСУБД любой допустимый фрагмент кода.
Условие - это часть запроса, содержащая по крайней мере одно ключевое слово и соответствующую информацию, которая будет 
использоваться вместе с этим ключевым словом. *Ключевые слова* - пишутся ЗАГЛАВНЫМИ буквами.
![IMG_E8789.JPG](foto%2FIMG_E8789.JPG)

### Работа с базой данных в SQLite
Структуру файла базы данных можно изучить на вкладке: **Database Structure**. Вкладка **Browse Date** используется 
для просмотра отдельных записей в таблице , которые можно выбрать из раскрывающегося меню. Вкладку **Execute SQL** 
используют, чтобы написать, а затем выполнить запрос SQL.


### Работа с запросами
- Рекомендуется добавлять комментарии к запросам. Базовый блок комментариев может содержать имя разработчика, дату создания запроса и краткое описание запроса.
- При написании запроса полезно сначала сформулировать вопрос на человеческом языке, а затем определить необходимые ключевые слова и условия.
- Запрос обычно начинается с условия SELRCT, которое указывает, какие поля выводить из таблицы, указанной в условии FROM.
- Псевдонимы в SQL используется для присвоения таблице или столбцу в таблице временного имени. Псевдонимы позволяют 
сделать имена столбцов более удобочитаемыми. псевдоним существует только на время выполнения запроса. AS [Например псевдоним].
- Использование условия ORDER BY позволяет сортировать записи в алфавитном порядке (ASC) или в обратном порядке (DESC).
- С помощью условия LIMIT (после условия ORDER BY) можно получать ограниченное число записей. Для этого вам необходимо указать количество результатов которые хотите показать.
### Преобразование данных в информацию

**Операторы** - это специальные ключевые слова в SQL, которые мы используем вместе с условиями для сравнения знаний полей, 
выбора подмножеств полей или выполнения арифметических операция ![IMG_E8867.JPG](foto%2FIMG_E8867.JPG)

- фильтрация данных условие **WHERE**, для фильтрации данных (числа, текст и даты) используется вместе с операторами. 
Условие WHERE всегда следует после условия FROM но всегда находится перед ORDER BY.
- Использования оператора **LIKE**  - он использует подстановочные знаки представленные символом %, с помощью 
подстановочного знака можно задать любое количество символов и любого типа. Примеры:  ![IMG_E8868.JPG](foto%2FIMG_E8868.JPG)
![IMG_E8869.JPG](foto%2FIMG_E8869.JPG) ![IMG_E8870.JPG](foto%2FIMG_E8870.JPG)
- При работе с датами можно убрать из запроса время функцией **DATE()** - DATE(Таблица) = '2009-01-03'
- При использовании операторов **AND** и **OR**, сначадо выполняется AND а потом OR поэтому для конкретизации условий 
фильтра ставь (), пример - Таблица > 2 AND (Вторая Таблица LIKE 'p%' OR Вторая Таблица LIKE 'd%')
- Оператор **CASE** позволяет создать новое временное поля в базе данных, которое станет меткой для данных на основе 
заданных условий, после чтобы написать название метки необходимо поставить оператор THEN  и название в одинарных кавычках. 
последние условие фильтруем через ключевое слово ELSE. Пример:![IMG_E8871.JPG](foto%2FIMG_E8871.JPG)


### Соединение таблиц
соединение используется для вывода данных из разных таблиц, при выборе полей из нескольких таблиц для указания исходной таблицы необходимо использовать псевдонимы
#Внутреннее соединение не включает строки для которых нет соответствующих данных
#Внешнее соединение включает все строки одной таблицы, даже если между таблицами нет соответствующих данных. Несоответствующие строки будут отображаться как **NULL**.
Для проверки нулевых значений необходимо использовать специальные операторы **IS** и **NOT**
Пример:

SELECT
e.FirstNamr, (псевдоним и поле которое нужно отобразить)
e.LastName,
e.EmployeeId,
c.FirstName,
c.LastName,
i.CustomerId,
i.Total
FROM  (название таблицы и придумываем псевдоним)
invoices AS i
INNER JOIN (lEFT JOIN) (внутреннее или внешнее соединение еще есть правое соединение но можно просто поменять местами операторы)
customers AS c (с какой таблицей соединение)
ON
i.CustomerId = c.CustomerId (по каким полям идет соединение)
INNER JOIN  (еще соединение)
employees AS e
ON
c.SupportRepId = e.EmployeeId
WHERE (исключение)
c.LastName IS NULL (включать только пустые значения, можно не включать тогда NOT NULL)
ORDER BY
i.Total DESC (группировать в обратном порядке по полю Total)
LIMIT 10 (лимит полей для отображения)

### Функции глава 7 книги
Функции позволяют изменять, форматировать, формировать и выполнять вычисления с данными в таблицах: это специальные ключевые слова: которые разделяются на три типа
**Строковые** (INSTR() LENGTH() SUBSTR() UPPER() TRIM()), **даты и времени** (DATE() DATETIMME() 'NOW'...) , **агрегатные** (AVG() COUNT() MAX() MIN() SUM())
Можно объединять столбцы с помощью FirstName || LastName AS (Пример)

Запросы, содержащие числовые данные, можно обрабатывать с помощью различных арифметических операций и агрегатных функций

Запросы, содержащие текс, можно разделить, объединить, использовать для них заглавные буквы и тд

После агрегирования данные можно дополнительно отсортировать с помощью условий GROUP BY и HAVING.

Условие HAVING работает с агрегатными полями так же, как условие WHERE с неагрегатными
HAVING можно использовать в в запросе , только если имеется условие GROUP BY.

Условие GROUP BY можно использовать с несколькими полями, чтобы еще больше детализировать агрегатные данные


### Функции глава 7 книги
Функции позволяют изменять, форматировать, формировать и выполнять вычисления с данными в таблицах: это специальные ключевые слова: которые разделяются на три типа
**Строковые** (INSTR() LENGTH() SUBSTR() UPPER() TRIM()), **даты и времени** (DATE() DATETIMME() 'NOW'...) , **агрегатные** (AVG() COUNT() MAX() MIN() SUM())
Можно объединять столбцы с помощью FirstName || LastName AS (Пример)

Запросы, содержащие числовые данные, можно обрабатывать с помощью различных арифметических операций и агрегатных функций

Запросы, содержащие текс, можно разделить, объединить, использовать для них заглавные буквы и тд

После агрегирования данные можно дополнительно отсортировать с помощью условий GROUP BY и HAVING.

Условие HAVING работает с агрегатными полями так же, как условие WHERE с неагрегатными
HAVING можно использовать в в запросе , только если имеется условие GROUP BY.

Условие GROUP BY можно использовать с несколькими полями, чтобы еще больше детализировать агрегатные данные

## Глава 8 Подзапросы
Подзапросы позволяют выполнить в одном запросе несколько операторов SQL.

Это обычный запрос, вложенный в другой.

Можно использовать с условием WHERE (используется для фильтрации) например
WHERE
InvoiceData >= '2013-01-01' AND total > (select max(Total) FROM invoices where InvoiceDate < '2013-01-01')

Условие **DISTINCT** (отображает только уникальные значения, то есть повторных значений не будет)

## Глава 9 Представления

это виртуальные запросы, созданные SQL на которые можно ссылаться в других запросах

Представления создаются посредством добавления запроса следующего условия: CREATE VIEW V_(название 
для сохранения) AS, например:

CREATE VIEW V_CityAvgVsGlobal
SELECT
BillingCity,
AVG(Total) AS [City Average],
(SELECT *
FROM V_GlobalAverage)
FROM
invoices
GROUP BY
BillingCity
ORDER BY
BillingCity

тут мы и создаем и ссылаемся на представления

Представления полезны при написании длинных запросов и когда они постоянно нужны

## Глава 10 DML - язык управления данными

***Добавление, редактирование и удаление.***

Данными в Реляционных СУБД можно управлять с помощью следующих DML команд:
INSERT, UPDATE, DELETE.

Пример добавления данных:
INSERT INTO
artists (Name)
VALUES ('Bob Marley')

Если в добавлении в строку нет данных например у человека нет номера факса и т.д., то в запросе нужно 
закинуть пустоту в одинарных кавычках  - ' ', иначе будет ошибка.
Пример
INSER INTO
employees
VALUES ('9', 'Martin', 'Ricky', ' ', 'krasti-vip@yandex.ru')
Очень важно следить за порядком внесения данных

**Обновление данных** -

происходит командой UPDATE с ключевым словом SET, как правило применяется с условием WHERE, оно 
необходимо чтобы указать на строки которые будут обновлены, иначе обновятся все строки в таблице.  
Пример:

UPDATE
employees
SET PostalCode = '11202'
WHERE
EmployeeId = 9
стоить помнить если строки еще не добавлены то будет ошибка

**Удаление данных**

Оператор DELETE используется так же с условием WHERE иначе удалятся все строки в таблице

ВАЖНО помнить что не нужно сразу стремится обновить или удалить данные, лучше заменить оператор на 
SELECT и посмотреть что ты хочешь удалить

Пример:
SELECT * FROM
employees
WHERE
EmployeeID = 9

посмотрели и потом  -
DELETE FROM
employees
WHERE
EmployeeID = 9